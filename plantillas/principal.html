{% extends "base.html" %}

{% load staticfiles %}



{% block contenido %}


<div class="widget">

  <div class="widget-head">
    <div class="pull-left">Lista de Spots</div>
    {% if user.is_superuser %}
    <form action="/buscar/" method="POST" > {% csrf_token %}
      <div>

      </div>
      
      <div class="pull-right">
        <label for="">Fecha Inicial: <input type="text" name="f_inicial" id="datepicker"></label>
        <label for="">Fecha Final: <input type="text" name="f_final" id="datepickers"></label>
        
        
        <label for="">Usuario: <input type="text" name="buscar"></label>
        <button class="btn search-button" type="submit">
          <i class="fa fa-search"></i>
        </button>
        
      </div>
      
    </form>
    {% endif %}
    <div class="clearfix"></div>
  </div>

  <div class="widget-content">
    {% if user.is_active and not user.is_staff %}
    <table id="datatable" class="table table-striped table-bordered table-hover">
      <thead>
        <tr>
          <th>#</th>
          <th>Nombre de Spot</th>
          {% if user.is_staff %}<th>Usuario</th>{% endif %}
          <th></th>
        </tr>
      </thead>

      {% if user.is_staff %}

      {% for usuario in usuario_admin.object_list %}

      <tr>
        <td>{{forloop.counter}}</td>
        <td>{{ usuario.nombre }}</td>
        {% if user.is_staff %}
        <td>{{usuario.usuario}}</td>
        <td>
          <button class="btn btn-xs btn-success" onclick=location.href="{% url 'detalle_spot' usuario.id %}"><i class="label label-success"></i>Detalless</button>
        </td>
        {% endif %}
        
      </tr>
      {% empty %}
      <tr>
        <td colspan="4">No hay registro</td>
      </tr>

      {% endfor %}                                           
      {% endif %}

      {% if user.is_active and not user.is_staff %}

      {% for usuario in servicio.object_list %}

      <tr>
        <td>{{forloop.counter}}</td>
        <td>{{ usuario.nombre }}</td>          
        <td>
         <a href="{% url 'editar_orden' usuario.id %}">
          <button class="btn btn-xs btn-warning" onclick="confirmar({{usuario.id}})"><i
            class="fa fa-pencil"></i></button>
          </a>

        </td>

      </tr>
      {% empty %}
      <tr>
        <td colspan="4">No hay registro</td>
      </tr>
      {% endfor %}

      {% endif %}



    </table>

    {% if servicio.object_list and servicio.paginator.num_pages > 1 %}
    <div class="widget-foot">
      <span class="pagination pull-right">
        {% if servicio.has_previous %}

        <a href="?page={{ servicio.previous_page_number }}"> anterior &lt;&lt; </a>

        {% endif %}

        <span>
          &nbsp;Página {{ servicio.number }} de {{ servicio.paginator.num_pages }}
        </span>

        {% if servicio.has_next %}
        <a href="?page={{ servicio.next_page_number }}"> &gt;&gt; siguiente</a>
        {% endif %}
      </span>
    </div>

    {% endif %}

    {% endif %}








    {% if user.is_superuser %}
    <table id="datatable" class="table table-striped table-bordered table-hover">
      <thead>
        <tr>

          <th>#</th>
          <th>Usuario</th>

          {% if user.is_superuser %}<th></th>
          <th></th>{% endif %}
        </tr>
      </thead>
      <tbody>


        {% if user.is_superuser %}

        {% for usuario in usuarios.object_list %}


        <tr>
          <td>{{forloop.counter}}</td>
          <td>{{usuario.username}}</td>
          <td>
            <button class="btn btn-xs btn-success" onclick=location.href="{% url 'lista_spots_usuarios' usuario.id %}"><i class="label label-success"></i>Ver Spots</button>
          </td>
          <td>
            <button class="btn btn-xs btn-danger" onclick=location.href="{% url 'lista_spots_usuarios_pdf' usuario.id %}"><i class="label label-danger"></i>Generar PDF Spots</button>
          </td>


        </tr>
        {% empty %}
        <tr>
          <td colspan="4">No hay registro</td>
        </tr>

        {% endfor %}                                           
        {% endif %}

      </tbody>
    </table>

    {% if usuarios.object_list and usuarios.paginator.num_pages > 1 %}
    <div class="widget-foot">
      <span class="pagination pull-right">
        {% if usuarios.has_previous %}

        <a href="?page={{ usuarios.previous_page_number }}"> anterior &lt;&lt; </a>

        {% endif %}

        <span>
          &nbsp;Página {{ usuarios.number }} de {{ usuarios.paginator.num_pages }}
        </span>

        {% if usuarios.has_next %}
        <a href="?page={{ usuarios.next_page_number }}"> &gt;&gt; siguiente</a>
        {% endif %}
      </span>
    </div>

    {% endif %}



    {% endif %}

  </div>




  {% if user.is_staff and not user.is_superuser %}


  <div class="widget-content">
   <table id="datatable" class="table table-striped table-bordered table-hover">
    <thead>
      <tr>

        <th>#</th>

        <th>Nombre del spot</th>
        <th>Descripción</th>
        <th>Archivo de texto</th>
        <th>Archivo de referencia</th>
        <th>Usuario</th>
      </thead>
      <tbody>



        {% for list_user in usuario_staff %}


        <tr>
          <td>{{forloop.counter}}</td>
          <td>{{list_user.nombre}}</td>
          <td>{{list_user.descripcion}}</td>
          <td>
            {% if list_user.archivo_texto %}
            <a href="{{ list_user.archivo_texto.url }}">{{list_user.archivo_texto}}</a>
            {% endif %}
            
          </td>
          <td>
            {% if list_user.archivo_referencia %}
            <a href="{{ list_user.archivo_referencia.url }}">{{list_user.archivo_referencia}}</a>
            {% endif %}
          </td>
          <td>{{list_user.usuario.username}}</td>



        </tr>
        {% empty %}
        <tr>
          <td colspan="4">No hay registro</td>
        </tr>

        {% endfor %}                                           
      </tbody>
    </table>
  </div>
  
  <div class="widget-head">
    <div class="pull-left">Historial</div>

    <div class="clearfix"></div>
  </div>

  <div class="widget-content">
   <table id="datatable" class="table table-striped table-bordered table-hover">
    <thead>
      <tr>

        <th>#</th>
        
        <th>Nombre del spot</th>
        <th>Descripción</th>
        <th>Archivo de texto</th>
        <th>Archivo de referencia</th>
      </tr>
    </thead>
    <tbody>



      {% for list_user in cambios_spot_staff %}


      <tr>
        <td>{{forloop.counter}}</td>
        <td>{{list_user.servicio}}</td>
        <td>{{list_user.descripcion}}</td>
        <td>
          {% if list_user.archivo_texto %}
          <a href="{{ list_user.archivo_texto.url }}">{{list_user.archivo_texto}}</a>
          {% endif %}
        </td>
        <td>
          {% if list_user.archivo_referencia %}
          <a href="{{ list_user.archivo_referencia.url }}">{{list_user.archivo_referencia}}</a>
          {% endif %}
        </td>




      </tr>
      {% empty %}
      <tr>
        <td colspan="4">No hay registro</td>
      </tr>

      {% endfor %}                                           
    </tbody>
  </table>



</div>

</div>
</div>
{% endif %}
{% endblock contenido %}
{% block script %}
<script type="text/javascript">
  function confirmar(id){
    if (confirm("¿Seguro que desea editar la orden?")) {
     // Respuesta afirmativa..
     window.location.href = '/ordenes/editar/'+id;
   }

 } 
   $( "#datepicker" ).datepicker({ dateFormat: "dd/mm/yy"});
  $( "#datepickers" ).datepicker({ dateFormat: "dd/mm/yy"});
</script>
{% endblock script%}